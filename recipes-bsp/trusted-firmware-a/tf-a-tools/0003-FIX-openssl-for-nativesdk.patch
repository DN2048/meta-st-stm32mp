From c9bbd3ac32d2850e8d0618f7bd29a747e0a8f0f9 Mon Sep 17 00:00:00 2001
From: Christophe Priouzeau <christophe.priouzeau@foss.st.com>
Date: Fri, 2 Sep 2022 10:18:51 +0200
Subject: [PATCH 3/3] FIX openssl for nativesdk

Signed-off-by: Christophe Priouzeau <christophe.priouzeau@foss.st.com>
---
 Makefile                   | 20 ++++++++++----------
 tools/cert_create/Makefile |  2 +-
 tools/fiptool/Makefile     |  3 +--
 3 files changed, 12 insertions(+), 13 deletions(-)

diff --git a/Makefile b/Makefile
index fd60b5fba..b6d979b4f 100644
--- a/Makefile
+++ b/Makefile
@@ -174,18 +174,18 @@ endif
 # Toolchain
 ################################################################################
 
-HOSTCC			:=	gcc
+HOSTCC			?=	gcc
 export HOSTCC
 
-CC			:=	${CROSS_COMPILE}gcc
-CPP			:=	${CROSS_COMPILE}cpp
-AS			:=	${CROSS_COMPILE}gcc
-AR			:=	${CROSS_COMPILE}ar
-LINKER			:=	${CROSS_COMPILE}ld
-OC			:=	${CROSS_COMPILE}objcopy
-OD			:=	${CROSS_COMPILE}objdump
-NM			:=	${CROSS_COMPILE}nm
-PP			:=	${CROSS_COMPILE}gcc -E
+# CC			:=	${CROSS_COMPILE}gcc
+# CPP			:=	${CROSS_COMPILE}cpp
+# AS			:=	${CROSS_COMPILE}gcc
+# AR			:=	${CROSS_COMPILE}ar
+# LINKER			:=	${CROSS_COMPILE}ld
+# OC			:=	${CROSS_COMPILE}objcopy
+# OD			:=	${CROSS_COMPILE}objdump
+# NM			:=	${CROSS_COMPILE}nm
+# PP			:=	${CROSS_COMPILE}gcc -E
 DTC			:=	dtc
 
 # Use ${LD}.bfd instead if it exists (as absolute path or together with $PATH).
diff --git a/tools/cert_create/Makefile b/tools/cert_create/Makefile
index 77d2007d5..c14bdee58 100644
--- a/tools/cert_create/Makefile
+++ b/tools/cert_create/Makefile
@@ -9,7 +9,7 @@ V		?= 0
 DEBUG		:= 0
 CRTTOOL		?= cert_create${BIN_EXT}
 BINARY		:= $(notdir ${CRTTOOL})
-OPENSSL_DIR	:= /usr
+OPENSSL_DIR	?= /usr
 COT		:= tbbr
 
 MAKE_HELPERS_DIRECTORY := ../../make_helpers/
diff --git a/tools/fiptool/Makefile b/tools/fiptool/Makefile
index 7c2a08379..24d48b3cd 100644
--- a/tools/fiptool/Makefile
+++ b/tools/fiptool/Makefile
@@ -8,12 +8,11 @@ MAKE_HELPERS_DIRECTORY := ../../make_helpers/
 include ${MAKE_HELPERS_DIRECTORY}build_macros.mk
 include ${MAKE_HELPERS_DIRECTORY}build_env.mk
 
+OPENSSL_DIR ?= /usr
 FIPTOOL ?= fiptool${BIN_EXT}
 PROJECT := $(notdir ${FIPTOOL})
 OBJECTS := fiptool.o tbbr_config.o
 V ?= 0
-OPENSSL_DIR := /usr
-
 
 override CPPFLAGS += -D_GNU_SOURCE -D_XOPEN_SOURCE=700
 HOSTCCFLAGS := -Wall -Werror -pedantic -std=c99
-- 
2.25.1

